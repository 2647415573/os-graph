

--- Page 261 ---
计算机操作系统
第几章·磁盘存储器的管理
磁盘存储器不仅容量大，存取速度快，而且可以实现随机存取，故它是当前实现虚拟
存储器和存放文件最理想的外存，因此在现代计算机系统中无一例外地都配置了磁盘存储
器。对磁盘存储器管理的主要任务和要求是：
（1）有效地利用存储空间。采取合理的文件分配方式，为文件分配必要的存储空间，
使每个文件都能“各得其所”，并能有效地减少磁盘碎片，改善存储空间的利用率。
(2）提高磁盘的I/O速度。通过各种途经，包含采用磁盘高速缓存等措施，来提高磁盘
的I/O速度，以增加对文件的访问速度，从而改善文件系统的性能。
（3）提高磁盘系统的可靠性。采取多种技术，其中包含必要的冗余措施和后备系统，
来提高磁盘系统的可靠性。
8.1外存的组织方式
如前所述，文件的物理结构直接与外存的组织方式有关。对于不同的外存组织方式，
将形成不同的文件物理结构。目前常用的外存组织方式有：
（1）连续组织方式。在对文件采取连续组织方式时，为每个文件分配一片连续的磁盘
空间，由此所形成的文件物理结构将是顺序式的文件结构。
（2）链接组织方式。在对文件采取链接组织方式时，可以为每个文件分配不连续的磁盘
（3）索引组织方式。在对文件采取索引组织方式时，所形成的将是索引式文件结构。在传
统的文件系统中，通常仅采用其中的一种组织方式来组织文件。在现代OS中，由于存在着多
种类型的、特别是实时类型的多媒体文件，因此，对文件可能采取了多种类型的组织形式。
8.1.1连续组织方式
连续组织方式又称连续分配方式，要求为每一个文件分配一组相邻接的盘块。例如，
第一个盘块的地址为b，则第二个盘块的地址为b+1，第三个盘块的地址为b+2，“"。通常，
它们都位于一条磁道上，在进行读/写时，不必移动磁头。在采用连续组织方式时，可把逻
辑文件中的记录顺序地存储到邻接的各物理盘块中，这样所形成的文件结构称为顺序文件
结构，此时的物理文件称为顺序文件。
这种组织方式保证了逻辑文件中的记录顺序与存储器中文件占用盘块的顺序的一致
性。为使系统能找到文件存放的地址，应在目录项的“文件物理地址”字段中记录该文件
250

--- Page 262 ---
第八章磁盘存储器的管理
第一个记录所在的盘块号和文件长度(以盘块为单位)。图8-1示出了连续组织方式的情况。
图中假定了记录与盘块的大小相同。Count文件的第一个盘块号是0，文件长度为2，因此
是在盘块号为0和1的两盘块中存放文件1的数据。
count
目录
file start
length
count
2
tr
14
3
mail
19
3
1213415
list
28
3
f
6
2
图8-1磁盘空间的连续组织方式
如同内存的动态分区分配一样，随着文件建立时空间的分配和文件删除时空间的回收，
将使磁盘空间被分割成许多小块，这些较小的连续区已难于用来存储文件，此即外存的碎
片。同样，我们也可以利用紧凑的方法，将盘上所有的文件紧靠在一起，把所有的碎片拼
接成一大片连续的存储空间。但为了将外存空闲空间进行一次紧凑，所花费的时间远比将
内存紧凑一次所花费的时间多。
连续组织方式的主要优点有：
（1）顺序访问容易。访问连续文件非常容易，系统可从目录中找到该顺序文件所在的第一
个盘块号，从此开始逐个盘块地往下读/写。连续分配也支持对定长记录的文件进行随机存取。
（2）顺序访问速度快。由连续分配所装入的文件，其所占用的盘块可能是位于一条或
几条相邻的磁道上，磁头的移动距离最少，因此，这种对文件访问的速度是几种存储空间
分配方式中最高的一种。
连续组织方式的主要缺点如下：
（1）要求为一个文件分配连续的存储空间。由内存的连续分配得知，这样便会产生出
许多外部碎片，严重地降低了外存空间的利用率。如果是定期地利用紧凑方法来消除碎片，
则又需花费大量的机器时间。
(2）必须事先知道文件的长度。要将一个文件装入一个连续的存储区中，必须事先知
道文件的大小。知道文件的大小有时只能靠估算，如果估计的文件大小比实际文件小，就
会因存储空间不足而中止文件的拷贝，要求用户重新估算后再次拷贝。这就促使用户将文
件长度估得比实际的大，从而造成浪费。
(3）不能灵活地删除和插入记录。为保持文件的有序性，在删除和插入记录时，都需
要对相邻的记录做物理上的移动，还会动态地改变文件的大小。
(4）对于那些动态增长的文件，由于事先很难知道文件的最终大小，因而很难为其分
配空间，而即使事先知道文件的最终大小，在采用预分配存储空间的方法时，也会使大量
的存储空间长期空闲。
251

--- Page 263 ---
计算机操作系统
8.1.2链接组织方式
如果可以将文件装到多个离散的盘块中，就可消除连续组织方式的上述缺点。在采用
链接组织方式时，可为文件分配多个不连续的盘块，再通过每个盘块上的链接指针，将同
属于一个文件的多个离散的盘块链接成一个链表，由此所形成的物理文件称为链接文件。
链接组织方式的主要优点是：
（1）消除了磁盘的外部碎片，提高了外存的利用率。
(2）对插入、删除和修改记录都非常容易。
(3）能适应文件的动态增长，无需事先知道文件的大小。
链接方式又可分为隐式链接和显式链接两种形式。
1.隐式链接
在采用隐式链接组织方式时，在文件目录的每个目录项中，都须含有指向链接文件第
一个盘块和最后一个盘块的指针。图8-2中示出了一个占用5个盘块的链接式文件。在相
应的目录项中，指示了其第一个盘块号是9，最后一个盘块号是25。而在每个盘块中都含
有一个指向下一个盘块的指针，如在第一个盘块9中设置了第二个盘块的盘块号是16；在
16号盘块中又设置了第三个盘块的盘块号1。如果指针占用4个字节，对于盘块大小为512
字节的磁盘，则每个盘块中只有508个字节可供用户使用。
目录
count
file
start length
jeep
9
25
4
8
12
14
15[
16
mai
119
1s
图8-2磁盘空间的链接式分配
隐式链接组织方式的主要问题在于，它只适合于顺序访问，它对随机访问是极其低效
的。如果要访问文件所在的第i个盘块，则必须先读出文件的第一个盘块，··""，就这样
顺序地查找直至第i块。当i=100时，需启动100次磁盘去实现读盘块的操作，平均每次都
要花费几十ms。可见，随机访问的速度很低。此外，只通过链接指针将一大批离散的盘块
链接起来，其可靠性较差，因为只要其中的任何一个指针出现问题，都会导致整个链的断开。
为了提高检索速度和减小指针所占用的存储空间，可以将几个盘块组成一个簇
(cluster)。比如，一个簇可包含4个盘块，在进行盘块分配时，是以簇为单位进行的。在链
接文件中的每个元素也是以簇为单位的。这样将会成倍地减小查找指定块的时间，而且也
可减小指针所占用的存储空间，但却增大了内部碎片，而且这种改进也是非常有限的。
252

--- Page 264 ---
第八章磁盘存储器的管理
2.显式链接
这是指把用于链接文件各物理块的指针显式地存放在内存的一张链接表中。该表在整
个磁盘中仅设置一张，如图8-3所示。表的序号是物理盘块号，从0开始，直至N-1；N
为盘块总数。在每个表项中存放链接指针，即下一
个盘块号。在该表中，凡是属于某一文件的第一个
物理块号
FAT
FCB
盘块号，或者说是每一条链的链首指针所对应的盘
0
块号，均作为文件地址被填入相应文件的FCB的“物
2
2
4
理地址”字段中。由于查找记录的过程是在内存中
3
4
进行的，因而不仅显著地提高了检索速度，而且大
5
大减少了访问磁盘的次数。由于分配给文件的所有
盘块号都放在该表中，故把该表称为文件分配表
图8-3显式链接结构
FAT(FileAllocation Table)。
8.1.3FAT技术
一
微软公司早、中期推出的操作系统一直都是采用的FAT技术。即利用文件分配表FAT
来记录每个文件中所有盘块之间的链接。在MS-DOS中，最早使用的是12位的FAT12，
后来为16位的FAT16。在Windows95和Windows98操作系统中则升级为32位的FAT32。
WindowsNT/2000/XP及以后的Windows操作系统又进一步发展为新技术文件系统
NTFS(NewTechnologyFileSystem)
在FAT中引I入了“卷”的概念，支持将一个物理磁盘分成四个逻辑磁盘，每个逻辑磁
盘就是一个卷（也称为分区），也就是说每个卷都是一个能够被单独格式化和使用的逻辑单
元，供文件系统分配空间时使用。一个卷中包含了文件系统信息、一组文件以及空闲空间。
每个卷都专门划出一个单独区域来存放自己的目录和FAT表，以及自己的逻辑驱动器字母。
需要指出的是，在现代OS中，一个物理磁盘可以划分为多个卷，一个卷也可以由多个物
理磁盘组成。
1. FAT12
FAT
FCB
0
1）早期的FAT12文件系统
FAT12是以盘块为基本分配单位的。由于FAT
4
2
3
是文件系统中最重要的数据结构，为了安全起见，
6
4
在每个分区中都配有两张相同的文件分配表FAT1
EOF
5
FCB
11=
6
和FAT2。在FAT的每个表项中存放下一个盘块号，
7
它实际上是用于盘块之间的链接的指针，通过它可
9
8
9
以将一个文件的所有的盘块链接起来，而将文件的
5—
第一个盘块号放在自己的FCB中。图8-4示出了
EOF-
MS-DOS的文件物理结构，这里示出了两个文件，
文件A占用三个盘块，其盘块号依次为4、6、11；
图8-4MS-DOS的文件物理结构
文件B则依次占用9、10及5号三个盘块。每个文
253

--- Page 265 ---
计算机操作系统
每个FAT中共含有2.4K个表项，由于每个FAT表项占12位，故FAT表占用3.6KB的存
储空间。
现在我们来计算以盘块为分配单位时所允许的最大磁盘容量。由于每个FAT表项为12
每个盘块（也称扇区）的大小一般是512字节，那么，每个磁盘分区的容量为2MB（4096×512B）；
一个物理磁盘能支持4个逻辑磁盘分区，所以相应的磁盘最大容量仅为8MB。这对最早时
期的硬盘还可应付，但很快磁盘的容量就超过了8MB，FAT12是否还可继续用呢，回答虽
是肯定的，但需要引入一个新的分配单位一簇。
2）以簇为单位的FAT12文件系统
稍加分析便可看出，如果把每个盘块（扇区）的容量增大n倍，则磁盘的最大容量便可
增加n倍。但要增加盘块的容量是不方便和不灵活的。为此，引入了簇（cluster）的概念。簇
是一组相邻的扇区，在FAT中它是作为一个虚拟扇区。在进行盘块分配时，是以簇作为分
配的基本单位。簇的大小一般是2n(n为整数)个盘块，在MS-DOS的实际运用中，簇的容
簇应包含扇区的数量与磁盘容量的大小直接有关。例如，当一个簇仅有一个扇区时，磁盘
的最大容量为8MB；当一个簇包含了八个扇区时，磁盘的最大容量便可达到64MB。
表中的项数（在相同的磁盘容量下，FAT表的项数是与簇的大小成反比)，使FAT表占用更
少的存储空间，并减少访问FAT表的存取开销：但这样也会造成更大的簇内零头（它与存储
器管理中的页内零头相似）。
FAT12存在的主要问题是，随着支持硬盘的容量的增加，相应的簇内碎片也将随之成
倍地增加，限制了磁盘的最大容量，通常只能是数十MB。此外，FAT12只能支持短文件
名，即8+3格式的文件名。
2.FAT16
FAT12对磁盘容量限制的原因在于，FAT12表中的表项有限制，亦即最多只允许4096
个。这样，随着磁盘容量的增加，必定会引起簇的大小和簇内碎片也随之增加。要想增加
FAT表中的表项数，就必须增加FAT表的位数(宽度)。如果我们将FAT表项位数增至16
位，最大表项数将增至65536(2")个，此时便能将一个磁盘分区分为65536(2")个簇。我
们把具有16位表宽的FAT表称为FAT16。在FAT16的每个簇中可以有的盘块数为4、8、，
直到64，由此得出FAT16可以管理的最大分区空间为216×64×512=2048MB。虽然FAT16
还必须很大，簇内碎片所造成的浪费也越大。例如，当要求磁盘分区的大小为8GB时，则
每个簇的大小达到128KB，这意味着内部零头最大可达到128KB。一般而言，对于1GB~
4GB的硬盘来说，大约会浪费10%～20%的空间。为了解决这一问题，微软推出了FAT32。
3.FAT32
由于FAT16表的长度只有65535项，随着磁盘容量的增加，簇的大小也必然会随之增
加，为了减少簇内零，也就应当增加FAT表的长度，为此需要再增加FAT表的宽度，这样
254

--- Page 266 ---
第八章磁盘存储器的管理
也就由FAT16演变为FAT32。
FAT32是FAT系列文件系统的最后一个产
块大小
FAT12
FAT16
FAT32
品。每一簇在FAT表中的表项占据4字节，允
0.5KB
2MB
许管理比FAT16更多的簇，允许采用较小的簇。
1KB
4MB
FAT32的每个簇都固定为4KB，即每簇为8个
2KB
8MB
128 MB
盘块，FAT32分区格式可以管理的单个最大磁盘
4 KB
16MB
256MB
1TB
空间大到4KB×23²=2TB。三种FAT类型的最
大分区以及所对应的块的大小如图8-5所示。
8KB
512MB
2TB
由于FAT32能支持更小的簇，使之具有更高
16 KB
1024MB
2TB
的存储器利用率。例如，两个磁盘容量都为2GB，
32KB
2048MB
2TB
一个磁盘采用了FAT16文件系统，簇的大小为
图8-5FAT中簇的大小与最大分区的对应关系
32KB；另一个磁盘采用了FAT32文件系统，簇
的大小只有4KB。通常情况下，FAT32比FAT16的存储器利用率提高了15%。FAT32主要
应用于Windows98及后续Windows系统，同时支持长文件名，能够有效地节省硬盘空间。
FAT32仍然有着明显的不足之处：首先是由于文件分配表的扩大，运行速度比FAT16
格式要慢：其次，FAT32有最小管理空间的限制，FAT32卷必须至少有65537个簇，所以
FAT32不支持容量小于512MB的分区，因此对于小分区，则仍然需要使用FAT16或FAT12。
再之，FAT32的单个文件的长度也不能大于4GB；最后，FAT32最大的限制在于兼容性方
面，FAT32不能保持向下兼容。
8.1.4NTFS的文件组织方式
1.NTFS新特征
NTFS(NewTechnologyFileSystem)是一个专门为WindowsNT开发的、全新的文件系
统，并适用于Windows2000/XP及后续的WindowsOS。NTFS具有许多新的特征：
首先，它使用了64位磁盘地址；
其次，在NTFS中可以很好地支持长文件名，单个文件名限制在255个字符以内，全
路径名为32767个字符；
第三，具有系统容错功能，即在系统出现故障或差错时，仍能保证系统正常运行；
第四，能保证系统中的数据一致性，这是一个非常有用的功能。
此外NTFS还提供了文件加密、文件压缩等功能。
2.磁盘组织
NTFS是以簇作为磁盘空间分配和回收的基本单位的。一个文件占用若干个簇，一个
簇只属于一个文件。这样，在为文件分配磁盘空间时，就无须知道盘块的大小，只要根据
不同的磁盘容量，选择相应大小的簇，即使NTFS具有了与磁盘物理块大小无关的独立性。
在NTFS文件系统中，把卷上簇的大小称为“卷因子”，卷因子是在磁盘格式化时确定
的，其大小也是物理磁盘扇区的整数倍。簇的大小可由格式化命令按磁盘容量和应用需求
来确定，可以为512B、1KB、·，最大可达64KB。对于小磁盘(≤512MB)，默认簇大
小为512字节；对于1GB磁盘，默认簇大小为1KB；对于2GB的磁盘，则默认簇为4KB。
255

--- Page 267 ---
计算机操作系统
事实上，为了在传输效率和簇内碎片之间进行折中，NTFS在大多数情况下都是使用4KB。
对于簇的定位，NTFS是采用逻辑簇号LCN(LogicalClusterNumber)和虚拟簇号
简单的编号，NTFS在进行地址映射时，可以通过卷因子与LCN的乘积，算出卷上的物理
字节偏移量，从而得到文件数据所在的物理磁盘地址。为了方便文件中数据的引I用，NTFS
还可以使用VCN，以文件为单位，将属于某个文件的簇按顺序进行编号。只要知道了文件
开始的簇地址，便可将VCN映射到LCN。
3.文件的组织
在NTFS中，以卷为单位，将一个卷中的所有文件信息、目录信息以及可用的未分配
空间信息，都以文件记录的方式记录在一张主控文件表MFT(MasterFileTable)中，该表是
NTFS卷结构的中心，从逻辑上讲，卷中的每个文件作为一条记录，在MFT表中占有一行，
其中还包括MFT自已的这一行。每行大小固定为1KB，每行称为该行所对应文件的元数
据（metadata），也称为文件控制字。
在MFT表中，每个元数据都将其所对应文件的所有信息（包括文件的内容等）组织在所
对应文件的一组属性中。由于文件大小相差悬殊，其属性所需空间大小也相差很大。当文
件较小时，其属性值所占空间也较小，可以将文件的所有属性直接记录在元数据中。而当
文件较大时，元数据仅能记录文件的一部分属性，其余属性，如文件的内容等，只好记录
到卷中的其它可用簇中，并将这些簇按其所记录文件的属性进行分类，分别链接成多个队
列，并将指向这些队列的指针保存在元数据中。
例如对于一个真正的数据文件，即属性为DATA的文件，如果很小，就直接将其存储
在MFT表中对应的元数据中，这样对文件数据的访问仅需要对MFT表进行访问即可，减
少了磁盘访问次数，显著地提高了对小文件存取的效率。如果文件较大，则文件的真正数
据往往保存在其它簇中。此时通过元数据中指向文件DATA属性的队列指针，可以方便地
查找到这些簇，完成对文件数据的访问。
实际上，文件在存储过程中，数据往往连续存放在若干个相邻的簇中，仅用一个指针记
录这几个相邻的簇即可，而不是每个簇需要一个指针，从而可以节省指针所耗费的空间。一
般地，采用上述方式，只需十几个字节就可以含有FAT32所需几百个KB才可拥有的信息量。
NTFS的不足之处在于，它只能被WindowsNT所识别。NTFS文件系统可以存取FAT
等文件系统的文件，但NTFS文件却不能被FAT等文件系统所存取，缺乏兼容性。Windows
的95/98/98SE和Me版都不能识别NTFS文件系统。
8.1.5索引组织方式
一一+
1.单级索引组织方式
链接组织方式虽然解决了连续组织方式所存在的问题（即不便于随机访问)，但又出现
了另外两个问题，即：①不能支持高效的直接存取，要对一个较大的文件进行存取，须在
FAT中顺序地查找许多盘块号；②FAT需占用较大的内存空间，由于一个文件所占用盘块
到一个文件的所有盘块号。当磁盘容量较大时，FAT可能要占用数MB以上的内存空间。
256

--- Page 268 ---
第八章磁盘存储器的管理
事实上，在打开某个文件时，只需把该文件占用的盘块的编号调入内存即可，完全没
有必要将整个FAT调入内存。为此，应将每个文件所对应的盘块号集中地放在一起，在访
问到某个文件时，将该文件所对应的盘块号一起调入内存。索引分配方法就是基于这种想
法所形成的一种分配方法。它为每个文件分配一个索引块（表），把分配给该文件的所有盘
块号都记录在该索引块中。在建立一个文件时，只须在为之建立的目录项中填上指向该索
引块的指针。图8-6示出了磁盘空间的索引分配图。
目录
file
块序号
jeep
19
96
03711
19
图8-6索引1分配方式
索引组织方式的主要优点是支持直接访问。当要读文件的第i个盘块时，可以方便地
直接从该文件的索引块中找到第i个盘块的盘块号；此外索引分配方式也不会产生外部碎
片。当文件较大时，索引分配方式无疑要优于链接分配方式。
索引组织方式的主要问题是，每当建立一个索引文件时，应为该文件分配一个索引块，
将分配给该文件的所有盘块号记录于其中。在每一个索引块中可存放数百个盘块号。但对
于中、小型文件，其本身通常只占有数个到数十个盘块，甚至更少，但仍须为之分配一索
引块。可见，对于小文件采用索引分配方式时，其索引块的利用率将是极低的。
2.多级索引组织方式
时，OS须再为该文件分配另一个索引块，用于将以后继续为之分配的盘块号记录于其中。依
此类推，再通过链指针将各索引块按序链接起来。显然，当文件太大，其索引块太多时，这种
方法是低效的。此时，应为这些索引块再建立一级索引，称为第一级索引，即系统再分配一个
索引块，作为第一级索引的索引块，将第一块、第二块、··等索引块的盘块号填入到此索引
表中，这样便形成了两级索引分配方式。如果文件非常大时，还可用三级、四级索引分配方式。
1KB，每个盘块号占4个字节，则在一个索引块中可存放256个盘块号。这样，在两级索引
时，最多可包含的存放文件的盘块的盘块号总数N=256×256=64K个。由此可得出结论：
采用两级索引时，所允许的文件最大长度为64MB。倘若盘块的大小为4KB，在采用单级索
引时所允许的最大文件长度为4MB，而在采用两级索引时所允许的最大文件长度可达4GB。
257

--- Page 269 ---
计算机操作系统
第二级索引
主索引
360
磁盘空间
360
105
0
740
106
254
2
740
105
106
356
357
254
1125
：
1125
356
357
985
985
图8-7两级索引分配
多级索引的主要优点是：大大加快了对大型文件的查找速度。其主要缺点是，在访问
一个盘块时，其所需启动磁盘的次数随着索引级数的增加而增多，即使是对于小文件，也
是如此。实际情况是，通常总是以中、小文件居多，而大文件是较少的。因此可见，如果
在文件系统中仅采用了多级索引组织方式，并不能获得理想的效果。
3.增量式索引组织方式
1）增量式索引组织方式的基本思想
为了能较全面地照顾到小、中、大及特大型作业，可以采取多种组织方式来构成文件
的物理结构。如果盘块的大小为1KB或4KB，对于小文件（如1KB～10KB或4KB～40KB）
而言，最多只会占用10个盘块，为了能提高对数量众多的小型作业的访问速度，最好能将
它们的每一个盘块地址都直接放入文件控制块FCB（或索引结点）中，这样就可以直接从
FCB中获得该文件的盘块地址。一般把这种寻址方式又称为直接寻址。对于中等文件（如
11KB～256KB或5KB～4MB)，可以采用单级索引I组织方式。此时为获得该文件的盘块
地址，只需先从FCB中找到该文件的索引表，从中便可获得，可将它称为一次间址；对于
大型和特大型文件，可以采用两级和三级索引组织方式，或称为二次间址和三次间址。所
谓增量式索引组织方式，就是基于上述的基本思想来组织的，它既采用了直接寻址方式，
又采用了单级和多级索引组织方式(间接寻址)。通常又可将这种组织方式称为混合组织方
式。在UNIX系统中所采用的就是这种组织方式。
2）UNIXSystemV的组织方式
在UNIXSystemV的索引结点中设有13个地址项，即i.addr(0)～i.addr(12)，如图8-8
所示。
（1）直接地址。为了提高对文件的检索速度，在索引结点中可设置10个直接地址项，
即用i.addr(0)～i.addr(9)来存放直接地址，也称为直接盘块号，即directblocks。换言之，在
这里的每项中所存放的是该文件数据所在盘块的盘块号。假如每个盘块的大小为4KB，当
258

--- Page 270 ---
第八章磁盘存储器的管理
文件不大于40KB时，便可直接从索引结点中读出该文件的全部盘块号。
(2）一次间接地址。对于大、中型文件，只采用直接地址是不现实的。为此，可再利
用索引|结点中的地址项i.addr（10)来提供一次间接地址（singleindirect)。这种方式的实质就是
一级索引分配方式。图中的一次间址块也就是索引块，系统将分配给文件的多个盘块号记
入其中。在一次间址块中可存放1K个盘块号，因而允许文件长达4MB。
（3）多次间接地址。当文件长度大于4MB+40KB时，使用一次间址与10个直接地
址项时地址空间仍不足，系统还需采用二次间址分配方式。这时，用地址项i.addr（11)提供
二次间接地址（doubleindirect)。该方式的实质是两级索引分配方式。系统此时是在二次间
址块中记入所有一次间址块的盘号。在采用二次间址方式时，文件最大长度可达4GB。同
理，地址项i.addr（12)作为三次间接地址（tripleindirect)，其所允许的文件最大长度可达4TB。
mode
owners (2)
time stamps (3)
size
data
block count
i.addr (0)
data
i.addr (1)
direct blocks
data
data
data
single indirect
data
data
doubleindirect
data
triple indirect
data
图8-8混合索引方式
8.2
文件存储空间的管理
为了实现前面任何一种文件组织方式，都需要为文件分配盘块，因此必须知道磁盘上
哪些盘块是可用于分配的。故在为文件分配磁盘时，除了需要文件分配表外，系统还应为
可分配存储空间设置相应的数据结构，即设置一个磁盘分配表（DiskAllocationTable)，用于
记住可供分配的存储空间情况。此外，还应提供对盘块进行分配和回收的手段。不论哪种
分配和回收方式，存储空间的基本分配单位都是磁盘块而非字节。下面介绍几种常用的文
件存储空间的管理方法。
8.2.1空闲表法和空闲链表法
1.空闲表法
1）空闲表
空闲表法属于连续分配方式，它与内存的动态分配方式雷同，它为每个文件分配一块
259