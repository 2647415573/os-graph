第十二章保护和安全

(4）购买性能优良的反病毒软件，按照规定要求使用，并定期升级。

（5）对于来历不明的电子邮件不要轻易打开。

(6）要定期检查硬盘及U盘，用反病毒软件来清除其中的病毒。

2.基于病毒数据库的病毒检测方法 通过被感染文件的长度或者日期和时间的改变来发现病毒的方法在早期还可奏效，而 现在这种检测方法虽然很难再有效，但伪装病毒还是难于逃避基于病毒数据库的病毒检测 方法的检查，该方法描述如下：

（1）建立病毒数据库。为了建立病毒数据库，首先应采集病毒的样本。为此，设计了 病毒数据库中所收集病毒样本的种类越多，用此方法去检测病毒的成功率也就越高。

（2）扫描硬盘上的可执行文件。将反病毒软件安装到计算机后，便可对硬盘上的可执 行文件进行扫描检查，看是否有与病毒数据库中样本相同的病毒，若发现有便将它清除。 但这种用可执行文件与病毒数据库中的病毒样本严格匹配的方式进行检测，却可能会漏掉 其它多种形态的病毒。 解决的方法是采用模糊查询软件，即使病毒有所变化，只要变化不是太大（如不超过三个 字节），都可以将它们检测出来。但模糊查询方法不仅使查询速度减慢，而且还会导致病毒扩 大化，以致使人们会把某些正常程序也误认为是病毒。一个比较完善的方法是使扫描软件能

3.完整性检测方法 完整性检测程序首先扫描硬盘，检查是否有病毒，当确信硬盘“干净”时，才正式工 作。这种方法首先计算每个文件的检查和，然后再计算目录中所有相关文件的检查和，将 所有检查和写入一个检查和文件中。在检测病毒时，完整性检测程序将重新计算所有文件 的检查和，并分别与原来文件的检查和进行比较，若不匹配，就表明该文件已被感染上病 查和文件中的正常值。为保证检查和文件中数据不被更改，应将检查和文件隐藏起来，更 好的方法是对检查和文件进行加密，而且把加密密钥直接做在芯片上。

112.6可信系统（TrustedSystem)

20 世纪70年代初，AndersonJP首先提出可信系统概念。当时对可信系统的研究主要 集中在OS的自身安全机制和支撑它的硬件环境上。为了能促成新一代可信硬件运算平台 的早日诞生，1999年10月由Intel、IBM、HP、Microsoft等公司成立了一个“可信计算平 台联盟”（TCPA)组织。该组织提出可信系统应包括可用性、可靠性、安全性、可维护性、 健壮性等多个方面。2003年4月，TCPA又重组为“可信计算组”TCG。

12.6.1访问矩阵模型和信息流控制模型 一一一一一一一 建立可信系统的最佳途径是保持系统的简单性。然而系统设计者认为，用户总是希望 401  计算机操作系统 系统具有强大的功能和优良的性能。这样，致使所设计出的OS存在许多安全隐患。有些 组织特别是军事部门，他们因为更重视系统的安全性，决心要建立一个可信系统，为此应 在OS核心中构建一个安全模型，模型要非常简单以确保模型的安全性。

1.安全策略 对系统安全而言，安全策略是根据系统对安全的需求所定义的一组规则及相应的描述。 该规则决定了对系统中数据进行保护的规则和规定每一个用户权限的规则，如哪些数据只 允许系统管理员阅读和修改；又如哪些数据只允许财务部门人员访问等。安全机制是指用 于执行安全策略时所必须遵循的规定和方法。

2.安全模型 安全模型用于精确描述系统的安全需求和策略。因此安全模型首先应当是精确的、同 时也应当是简单和容易理解的，而且不涉及安全功能的具体实现细节。安全模型能精确地 描述系统功能，这样就能帮助人们尽可能地堵住所有的安全漏洞。通常在OS设计时，系 统的功能描述用于指导系统功能的实现，而安全模型则指导与系统安全有关的功能实现。 现在已有几种安全模型，其中比较实用的是访问矩阵模型和信息流控制模型。

3.访问矩阵模型 一个客体都拥有矩阵中的一列。客体可以是程序、文件或设备。矩阵中的交叉项用于表示 某主体对某客体的存取权限集。保护矩阵决定在任何域中的进程可以执行的操作，它是由 系统强制执行的，而不是被管理者授权的操作。在有的保护矩阵中，除了客体能拥有矩阵 中的一列之外，主体也可拥有矩阵中的一列，此时矩阵中的交叉项所表示的是，相应行的 主体与相应列的主体之间是否允许进行通信等事宜。在访问矩阵模型中，矩阵的交叉项内 容的改变便意味着主体的访问权限的改变，因此必须对访问矩阵加以保护。

4.信息流控制（informationflowcontrol）模型 许多信息的泄密并非源于访问控制自身的问题，而是因为未对系统中的信息流动进行 限制。为此在一个完善的保护系统中，还增加了一个信息流控制模型。它是对访问矩阵模 型的补充，用于监管信息在系统中流通的有效路径，控制信息流从一个实体沿着安全途径 流向另一实体。最广泛使用的信息流控制模型是Bell-LaPadula模型，该模型主要用于军事 部门。在该模型中把信息分为四等：内部级(U)、秘密级(C)、机密级(S)和绝密级(TS)。而 不同的人也将根据其级别，规定只能访问不同密级的信息。如将军为绝密级，相应地，他 可以访问所有的文件；而校级军官为机密级，他能访问机密级和更低密级的文件：而尉级 军官为秘密级，被限定只能访问秘密级和更低的文件，而一般士兵则仅能访问内部级文件。 由此可以得出，上校可以看上尉和士兵的文件，但决不能看将军的文件。由于该模型具有 多个安全等级，所以称为多级安全模型。在该模型中对信息的流动做出如下两项规定：

(1）不能上读。在密级k层中运行的进程，只能读相同或更低密级层中的对象。例如 允许将军阅读中尉拥有的文件，但不允许中尉阅读将军的文件，此规则称为简单安全规则。

(2）不能下写。在密级k层中运行的进程，只能写相同或更高密级层中的对象。例如 允许中尉在将军的信箱中添加信息，但不允许将军在中尉的信箱中添加信息，这样就不至 于把更高密级的内容下泄。此规则称为*规则。 402  第十二章保护和安全 只要系统严格执行了这两条规则，就能确保信息安全地流动，而不会发生信息从较高 安全级泄露到较低安全级的安全问题。另外还规定，进程可以读写对象，但不能相互直接 通信。图12-10示出了Bell-LaPadula模型。 安全等级 4 进程 对象 ①读 ①-g BL 图12-10Bell-LaPadula模型 的虚线表示进程正在写对象，信息从进程流向对象。图中示出了进程B正在从文件1中读 取信息，向文件3中写入信息。由图还可看出，无论是带箭头的实线还是带箭头的虚线， 它们都是水平方向或向上，而不具有向下方向的。这就是说信息没有往下流动的路径，因 此处于较高层中的信息不可能流到较低的密级层次中去，这样就保证了模型的安全性。

12.6.2可信计算基TCB（TrustedComputingBase) 一→ 可信任系统的核心是可信计算基TCB，它包含了用于检查所有与安全有关问题的访问 监视器和存放许多与安全有关的信息的安全核心数据库等。只要可信计算基按规范化形式 工作，就不会出现与安全有关的问题。

1.可信计算基的功能 的IO设备；在TCB中应配置OS最核心的功能，如进程创建、进程切换、内存映射以及 部分文件管理和设备管理功能。由于把它做得尽可能小，比较容易做正确性验证，因而TCB 软件自身是可信软件。在设计TCB时，应使其独立于OS的其余部分，在它和OS的其余 部分、计算机系统的其它部分之间提供安全接口。 在TCB中有一个十分重要的部分一—访问监视器，它要求所有与安全有关的问题都必 须集中在一处进行检查。为此，将访问监视器设置在内核空间的入口，使其成为进入内核 的唯一途经，所有与系统安全有关的访问都将通过它。访问监视器对这些请求进行检查， 只有合法请求系统才予以处理。而现在的大多数OS，为了提高效率和避免产生瓶颈，并不 采取这样的设计方法，这就是导致它们不很安全的重要原因。TCB结构如图12-11所示。 403  计算机操作系统 审核 记录文件 访问监视器 （策略） 主体 对象 安全核心数据库 主体：安全许可 对象：安全分类 图12-11可信任计算基TCB

2.安全核心数据库 为了对用户的访问进行安全控制，在TCB中配置了一个安全核心数据库。在数据库内 放入许多与安全有关的信息。其中最主要的是如下两个控制模型：

（1）访问控制模型，用于实现对用户访问文件的控制，其中列出了每个主体的访问权 限和每个对象的保护属性。

(2）信息流控制模型，用于控制信息流从一个实体沿着安全的途经流向另一个实体。

3.访问监视器 访问监视器是TCB中的一个重要组成部分，它基于主体和被访问对象的安全参数来控 制主体对该对象的访问，实现有效的安全接入控制。访问监视器与安全核心数据库相连接， 如图12-11所示。访问监视器可以利用安全核心数据库中存放的访问控制文件和信息流控 制文件对本次访问进行仲裁。访问监视器具有以下特性：

（1）完全仲裁。对每一次访问都实施安全规则，保证对主存、磁盘和磁带中数据的每 一次访问，均须经由它们的控制。为了提高系统的速度，通常有一部分功能由硬件实现。

(2）隔离。保证访问监视器和安全核心数据库的安全，任何攻击者都无法改变访问监 视器的逻辑结构以及安全核心数据库中的内容。

(3）可证实性。访问监视器的正确性必须是可证明的，即在数学上可以证明访问监视 器执行了安全规定，并提供了完全仲裁和隔离。 如果一个系统能具有上述三个特性，就可认为该系统就是一个可信任系统。在图中还 有一个审计及记录文件，将所检测到的安全违规、安全核心数据库中的授权变化等重要安 全事件都记录到审计文件中。

12.6.3设计安全操作系统的原则 如何设计一个高安全性的OS，是当今人们面临的一种挑战。人们经过长期的努力，提 出了若干设计安全OS的原则。

1.微内核原则 我们这里所说的微内核（通常将它们称为安全内核），与前面所说的微内核有着某些相 似之处，主要表现为：首先它们都非常小，易于保证它们的正确性；其次它们都采用了策 404  第十二章保护和安全 略与机制分离原则，即仅将机制部分放入安全内核中，而将策略部分放在内核的外面。它 们之间的差别主要表现在下面两方面：

（1）它不仅提供OS最核心的功能，如进程切换、内存映射等功能，还是实现整个OS 安全机制的基础。使安全内核成为一个可信任计算基。

（2）在通常的微内核中，进入微内核的入口有多个，而在安全系统中，系统的其它部 分与安全内核之间仅提供了唯一的安全接口。

2.策略与机制分离原则 原则，以减小安全内核的大小和增加系统的灵活性。安全策略规定系统要达到的特定安全 目标是由设计者或管理员来确定的，应将它放在安全内核外部。机制是完成特定安全策略 的方法，由一组具体实现保护功能的软件或硬件实现，应将它放入安全内核中。

3.安全入口原则 在通常的微内核中，都采用了C/S模式，微内核与所有的服务器之间都存在着接口， 因此可以通过多种途径进入微内核，这也就为保障OS的安全增加了困难。而在安全系统 中为确保安全内核的安全，在安全内核与其它部分之间，如与其它的硬件、系统和用户软 件等之间，只提供唯一的安全接口，凡是要进入安全内核进行访问者，都必须接受严格的 安全检查，任何逃避检查的企图都是不能得逞的。

4.分离原则 可用多种方法来将一个用户进程与其他用户进程进行隔离，主要分离方法有：

（1）物理分离。使各进程的活动基于不同的硬件设施。例如，在对安全性要求较高的 任务进行处理时，可用专用的计算机来完成；对安全性要求一般的任务，可在公用计算机 系统上来完成。

（2）时间分离。让各进程在不同的时间运行。

(3）密码分离。对用于加密的密钥和密文必须妥善分开保管。

(4）逻辑分离。为确保安全内核的安全，安全内核应与其它部分的硬件和软件进行隔离。

5.部分硬件实现原则 在安全内核中有一部分须用硬件实现，其原因可归结如下：

(1）提高处理速度。为了不影响到系统的运行速度，应将对运行速度有严重影响的部 分采用硬件实现。

(2）确保系统的安全性。用软件实现容易受到攻击和病毒的感染，如改用硬件实现就 会安全得多。 随着大规模集成电路的发展，其成本变得越来越低，用硬件实现不会给安全系统带来 太大的经济负担。

6.分层设计原则 核，第三层是OS，最高层是用户。其中每一层又都可分为若干个层次。安全保护机制在满 足要求的情况下，应力求简单一致，并将它的一部分放入到系统的安全内核中，把整个安 405  计算机操作系统 全内核作为OS的底层，使其最接近硬件。 值得一提的是，如果一个系统的安全性没有按照上述的原则进行设计，必然会留下许 多隐患。而只是试图在原有操作系统基础上增加几个安全软件，或者增加一个安全管理层， 使之成为一个安全系统，几乎是不可能的。这也就是何以在目前的OS中，对所存在的安 全隐患虽经无数次的修改，其安全性能仍不能令人满意的原因。

1.系统安全性的主要目标是什么？

2.系统安全性的复杂性表现在哪几个方面？

3.对系统安全性的威胁有哪几种类型？

5.何谓对称加密算法和非对称加密算法？

6.什么是易位法和置换算法？试举例说明置换算法。

7.试说明非对称加密算法的主要特点。

8.试说明保密数据签名的加密和解密方式。

9.数字证明书的作用是什么？用一例来说明数字证明书的申请、发放和使用过程。

10.可利用哪几种方式来确定用户身份的真实性？

11.在基于口令机制的认证技术中，通常应满足哪些要求？

12.试说明一种对加密口令进行验证的方法。

13.基于物理标志的认证技术又可细分为哪几种？

14.智能卡可分为哪几种类型？这些是否都可用于基于用户持有物的认证技术中？

15.被选用的生理标志应具有哪几个条件？请列举几种常用的生理标志。

16.对生物识别系统的要求有哪些？一个生物识别系统通常是由哪儿部分组成？

17.早期常采用的内部攻击方式有哪几种？

18.何谓逻辑炸弹？较常用的引爆条件有哪些？

19.何谓陷阱门和特洛伊木马？试举例说明之。

20.何谓缓冲区溢出？攻击者如何利用缓冲区溢出进行攻击？

21.什么是病毒和蠕虫？它们之间有何异同处？

23.计算机病毒的特征是什么？它与一般的程序有何区别？

24.计算机病毒有哪几种类型？试简单说明之。

25.什么是文件型病毒？试说明文件型病毒对文件的感染方式。

26.病毒设计者采取了哪几种隐藏方式来让病毒逃避检测？

27.用户可采用哪些方法来预防病毒？

28.试说明基于病毒数据库的病毒检测方法。 406